# git-status.toml â€” compact file listing with native git status codes
# Raw: 30+ lines of verbose git status with hints
# Filtered: branch name + one porcelain-format line per changed file

command = "git status"

# Override: use porcelain for reliable machine parsing
run = "git status --porcelain -b"

match_output = [
  { contains = "not a git repository", output = "Not a git repository" },
]

replace = [
  # Detached HEAD
  { pattern = '^## HEAD \(no branch\).*$', output = "HEAD (detached)" },
  # Branch with ahead/behind info: ## main...origin/main [ahead 2]
  { pattern = '^## (\S+?)(?:\.\.\.\S+)?\s+\[(.+)\]$', output = "{1} [{2}]" },
  # Branch without ahead/behind: ## main...origin/main  or  ## main
  { pattern = '^## (\S+?)(?:\.\.\.\S+)?$', output = "{1}" },
  # File lines pass through unchanged (XY codes are standard and understood by models)
]
